jQuery(document).ready(function ($) {
  $(".form-cek-resi").on("submit", function (e) {
    e.preventDefault();

    // Ambil nomor AWB dari input
    var awbNumber = $("#tracking").val();

    $("#modalResiContent").html(
      '<div class="modal-header"><h1 class="modal-title fs-5" id="modalResiLabel">Memuat data</h1><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body text-center" id="modalResiBody"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button></div>'
    );

    // Lakukan validasi nomor AWB (sesuai kebutuhan)
    if (!awbNumber) {
      alert("Masukkan No AWB");
      return;
    }

    // Kirim permintaan Ajax
    $.ajax({
      type: "POST",
      url: sweetaddons.ajaxurl, // Variabel global WordPress untuk URL Ajax
      data: {
        action: "get_post_by_awb",
        awbNumber: awbNumber,
      },
      success: function (response) {
        // Tampilkan data post dalam modal
        $("#modalResiContent").html(response);
        // $("#modalResi").modal("show");
      },
      error: function (error) {
        console.log(error);
      },
    });
  });
});


// Mengecek apakah data sudah ada di local storage
if (!localStorage.getItem('provincesData')) {
  // Jika tidak ada, maka ambil data dari URL
  fetch('https://aadiityaak.github.io/api-wilayah-indonesia/api/provinces.json')
    .then(response => response.json())
    .then(data => {
      // Mengonversi data menjadi string JSON
      const jsonString = JSON.stringify(data);

      // Menyimpan string JSON ke local storage dengan kunci tertentu
      localStorage.setItem('provincesData', jsonString);

      console.log('Data berhasil diambil dan disimpan di local storage.');
    })
    .catch(error => console.error('Terjadi kesalahan:', error));
} else {
  console.log('Data sudah ada di local storage.');
}
